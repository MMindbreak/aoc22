open System
open System.IO
open FSharp.Collections

let lines =
    File.ReadLines("/home/emile/recreational_programming/aoc22/src/aoc2/input")



type Hand =
    | Rock
    | Paper
    | Scissors

let getHandValue hand =
    match hand with
    | Rock -> 1
    | Scissors -> 3
    | Paper -> 2

type Outcome =
    | Loss
    | Equal
    | Win

let getOutcomeValue outcome =
    match outcome with
    | Loss -> 0
    | Equal -> 3
    | Win -> 6

let matchEnemy input : Hand =
    match input with
    | "A" -> Rock
    | "B" -> Paper
    | "C" -> Scissors
    | _ -> raise (ArgumentException($"{input} is not a valid value"))

let matchRecommendation input =
    match input with
    | "X" -> Rock
    | "Y" -> Paper
    | "Z" -> Scissors
    | _ -> raise (ArgumentException($"{input} is not a valid value"))

let readLine (line: string) =
    let inputs = line.Split(" ")
    matchEnemy (inputs[0]), matchRecommendation (inputs[1])

let getOutcome (opponent: Hand) (player: Hand) =
    match opponent, player with
    | Rock, Paper -> Win
    | Rock, Scissors -> Loss
    | Paper, Scissors -> Win
    | Paper, Rock -> Loss
    | Scissors, Rock -> Win
    | Scissors, Paper -> Loss
    | _ -> Equal

let getScore hand outcome =
    (getHandValue hand) + (getOutcomeValue outcome)

[<EntryPoint>]
let main argv =

    let endScore =
        (0, lines)
        |> Seq.fold (fun acc line ->
            let (opponent, recommendation) = readLine line
            let outcome = getOutcome opponent recommendation
            acc + (getScore recommendation outcome))

    for line in lines do
        let (opponent, recommendation) = readLine line
        let outcome = getOutcome opponent recommendation
        Console.WriteLine($"{opponent} {recommendation} {outcome} {getScore recommendation outcome}")

    0
